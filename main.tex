\documentclass[10pt]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm  }
\usepackage{fancyhdr}
\usepackage[margin=0.5in]{geometry}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{pdfpages}
\usepackage{standalone}
\usepackage{titling}
\usepackage{braket}
\usepackage{color}
\usepackage{hyperref}
\usepackage{wrapfig}
\usepackage{float}


\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{
  language=C,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=4
}

\newcommand{\NN}{\mathbb{N}} % Naturals
\newcommand{\ZZ}{\mathbb{Z}} % Integers
\newcommand{\QQ}{\mathbb{Q}} % Rationals
\newcommand{\RR}{\mathbb{R}} % Reals
\newcommand{\CC}{\mathbb{C}} % Imaginaries
\newcommand{\HH}{\mathbb{H}} % Quaternions
\newcommand{\FF}{\mathbb{F}} % Field

\newcommand{\ud}{\,\mathrm{d}} % Single-var differential (use like \partial)

\newcommand{\CoulombConstant}{\frac{1}{4\pi\epsilon_0}}

\DeclareMathOperator{\erf}{erf} % Error Function
\DeclareMathOperator{\erfc}{erfc} % Complementary Error Function
\DeclareMathOperator{\erfi}{erfi} % Imaginary Error Function
\DeclareMathOperator{\row}{row} % Matrix Row
\DeclareMathOperator{\col}{col} % Matrix Column
\DeclareMathOperator{\trace}{tr} % Matrix Trace
\DeclareMathOperator{\proj}{proj} % Vector Projection

\title{PHYS 319 Final Project: PWM-Based Synthesizer}
\author{Ashtan Mistal}
\date{April 2022}

\begin{document}

\maketitle

\break

\tableofcontents{}

\break

\section{Abstract}\label{sec:abstract}

% [abstract here]

\section{Introduction}\label{sec:introduction}

% [introduction here]
Exploration into the possibility of creating a user-controlled, MIDI\footnote{musical instrument digital interface}-compatible fully featured synthesizer has held a personal interest shortly after I became interested in music production itself. Motivation for this project to encompass this personal interest stemmed from first using pulse width modulation to change the brightness of a bulb during an earlier lab. Since my more recent interest in audio equipment itself, I was motivated to do an audio-related project. The purpose of this project, as a result, was to help me gain a further understanding into the inner workings of oscillators and envelope generators, gain an appreciation for the MIDI standard, and of course to have a working, hand-made synthesizer for future music production related use. All three areas of knowledge mentioned above would aid in future audio-related projects, both in software as well as in hardware, and help inspire for future related projects. This project builds off of my previous related experience in music production, which provided me with a background on audio synthesis and processing. 

\section{Theory}\label{sec:theory}
\input{theory}

\section{Apparatus}\label{sec:apparatus}

% Description of the project including diagrams of electrical and mechanical aspects. Depending on the complexity of the circuitry, a separate block diagram that shows functional blocks might be beneficial in addition to complete electrical schematics. The text should provide details on how the apparatus works. This section should also include a description of how your project is used.

\subsection{Apparatus Details}\label{subsec:apparatus-details}

The final rendition of this project is relatively simple in terms of electronics.
We begin by sending a signal of the same voltage to 10 different buttons, which act as the user control for the frequency of the wave emitted from the PWM. These buttons then go into a 10-bit DAC, which was done using a resistor ladder based on the R-2R architecture, where the resultant signal is read through a 10-bit ADC (thus allowing for the same level of precision for the DAC as is available for the ADC) that is built into the MSP430G2553 microprocessor. % expand more

% include circuit diagram

\subsection{How the project is used}\label{subsec:how-the-project-is-used}

The project is intended to be used similarly to a piano, with the 10 buttons available corresponding to various keys on a piano, ranging from A4 to C6, excluding sharps and flats in the note range. 

\subsection{Previous Apparatus Renditions}\label{subsec:previous-apparatus-renditions}

As the initial intention of this project was to include MIDI compatibility, it is important to also include circuit diagrams for this, given it offered different methods of user interaction. The rendition of the project that allowed for MIDI input was the 3 oscillator version (which, as will be discussed in the Results section, did not work properly due to hardware limitations). Thus, the apparatus diagram below will reflect this 


\section{Results}\label{sec:results}

% How did the device perform? Did it work according to the expectations? Comparison of theory to results obtained (as quantitative as possible). Problems encountered, graph(s) of data obtained, if appropriate, accuracy of the device (if it is a measuring instrument).


% TODO: 
% - Measure input on a FFT on Studio One (a spectral filter may be more accurate)
% - Compare to proper square wave
% - accuracy of the square wave frequency using a tuner



\section{Discussion}\label{sec:discussion}

% Discuss what went well, and what could have been better, possible improvements to the device.


\section{Conclusions}\label{sec:conclusions}

% Was it worth constructing? What did you learn?



%include references here
% Sources other than the course lab manual or lab web page should be referenced. Especially if your code is based on code you found on the web or elsewhere, you should make sure that the body of your report contains a clear citation to the source you used, and a corresponding reference here in the references section. In the body of the report, you should also explain clearly what differentiates your code from the source you used.

\appendix

\section{Appendix A: Table of Notes to Frequency Values}\label{sec:-table-of-notes-to-frequency-values}



% Any additional material that should be included in the report, but not necessary for the main body can be included as appendices. You should definitely include (well-annotated) program listings.

\begin{table}[h]
    \centering
    \begin{tabular}{c|c}
         &  \\
         & 
    \end{tabular}
    \caption{Table of Notes to Frequency Values}
    \label{tab:pianonotestofrequency}
\end{table}

\section{Appendix B: C Code for Decoding MIDI Data}\label{sec:appendix-b:-c-code-for-decoding-midi-data}
\input{appendix-b-c-code-for-decoding-midi-data}

\end{document}
